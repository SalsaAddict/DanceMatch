var Application;(function(n){function t(n){angular.isUndefined(n)||(n.preventDefault(),n.stopPropagation())}n.debugEnabled=!0;n.fbAppId="478292336279902";n.fbGraphApiVersion="v3.3";n.cancel=t})(Application||(Application={})),function(n){function i(){var n=function(n,i){n.when("/home",{name:"home",templateUrl:"views/home.html"}).when("/profile",{name:"profile",templateUrl:"views/demographics.html",controller:t.Controller,controllerAs:"ctrl"}).otherwise({redirectTo:"/home"}).caseInsensitiveMatch=!0;i.debugEnabled(!0)};return n.$inject=["$routeProvider","$logProvider"],n}function r(){var n=function(n,t){n.path("/login");t.debug("dm:run")};return n.$inject=["$location","$log"],n}var u,f,e,t,o;n.Config=i;n.Run=r,function(t){var i=function(){function t(n,t,i,r){this.$q=n;this.$http=t;this.$routeParams=i;this.$log=r}return t.prototype.execute=function(t,i){var f=this,r,u;return i===void 0&&(i={}),r=this.$q.defer(),u={name:t,routeParams:this.$routeParams||{},parameters:i||{},token:null},this.$http.post("execute.ashx",u).then(function(n){f.$log.debug("dm:execute:success",u,n);r.resolve(n.data)},function(t){n.debugEnabled?f.$log.error("dm:execute:error",u,t):f.$log.error("dm:execute:error","An unexpected error occurred.");r.reject(t.data)}),r.promise},t.$inject=["$q","$http","$routeParams","$log"],t}();t.Service=i}(u=n.Database||(n.Database={})),function(t){var i=function(){function t(t,i,r,u,f){var e=this;this.$rootScope=t;this.$window=i;this.dmDatabase=r;this.$location=u;this.$log=f;i.fbAsyncInit=function(){FB.init({appId:n.fbAppId,version:n.fbGraphApiVersion,status:!0});FB.Event.subscribe("auth.authResponseChange",function(n){e.$log.debug("dm:fb:authResponse",n);try{n.status==="connected"?FB.api("/me",{fields:["id","name"]},function(t){e.$log.debug("dm:fb:me2",t);r.execute("Login",t).then(function(){t.accessToken=n.authResponse.accessToken;e._login(t)},function(){e._logout()})}):e._logout()}catch(i){e._logout()}finally{t.$apply()}});f.debug("dm:fb:init")}}return t.prototype._login=function(n){this.$window.localStorage.setItem("user",angular.toJson(n,!1))},t.prototype._logout=function(){this.$window.localStorage.removeItem("user")},Object.defineProperty(t.prototype,"authenticated",{get:function(){return this.$window.localStorage.getItem("user")!=null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"user",{get:function(){return this.authenticated?angular.fromJson(this.$window.localStorage.getItem("user")):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.authenticated?this.user.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accessToken",{get:function(){return this.authenticated?this.user.accessToken:null},enumerable:!0,configurable:!0}),t.prototype.toggle=function(t){n.cancel(t);this.authenticated?FB.logout(angular.noop):FB.login(angular.noop)},t.prototype.goHomeIfNotAuthenticated=function(){return this.authenticated?!1:(this.$location.path("/home"),!0)},t.$inject=["$rootScope","$window","dmDatabase","$location","$log"],t}();t.Service=i}(f=n.Authentication||(n.Authentication={})),function(n){var t=function(){function n(n,t){var i=this;this.dmAuth=n;this.$rootScope=t;this.collapsed=!0;t.$on("$routeChangeSuccess",function(){i.collapsed=!0})}return n.prototype.toggle=function(){this.collapsed=!this.collapsed},n.prototype.$postLink=function(){},n.$inject=["dmAuth","$rootScope"],n}();n.Controller=t}(e=n.Menu||(n.Menu={})),function(n){var t=function(){function n(n,t,i){(this.$scope=n,this.dmAuth=t,this.dmDatabase=i,t.goHomeIfNotAuthenticated())||i.execute("Profile").then(function(t){n.demographics=t[0];i.execute("Age").then(function(t){n.ages=t;i.execute("Country").then(function(t){n.countries=t;i.execute("Quality").then(function(t){n.qualities=t})})})})}return n.prototype.save=function(){var n=this;if(this.$scope.form.$valid)this.dmDatabase.execute("DemographicsUpdate",this.$scope.demographics).then(function(){n.$scope.form.$setPristine()});else{this.$scope.form.$setSubmitted();return}},n.$inject=["$scope","dmAuth","dmDatabase"],n}();n.Controller=t}(t=n.Demographics||(n.Demographics={})),function(n){var t=function(){function n(n,t,i){this.$scope=n;this.dmDatabase=t;this.$routeParams=i;t.execute("Profile").then(function(i){n.profile=i[0];t.execute("Age").then(function(i){n.ages=i;t.execute("Country").then(function(i){n.countries=i;t.execute("Quality").then(function(t){n.qualities=t})})})})}return n.prototype.setDemographics=function(){this.dmDatabase.execute("SetDemographics",this.$scope.profile)},n.prototype.setImportance=function(n,t){this.dmDatabase.execute("SetImportance",{qualityId:n.id,ratingId:t}).then(function(){n.ratingId=t})},n.$inject=["$scope","dmDatabase","$routeParams"],n}();n.Controller=t}(o=n.Profile||(n.Profile={}))}(Application||(Application={}));angular.module("DanceMatch",["ngRoute","ngAnimate"]).config(Application.Config()).run(Application.Run()).service("dmDatabase",Application.Database.Service).service("dmAuth",Application.Authentication.Service).controller("dmMenuController",Application.Menu.Controller);